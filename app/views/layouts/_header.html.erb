<header class = "container-fluid navbar navbar-fixed-top">
  <div class = "container">
    <div class="row">
      <div class="col-md-1">
        <div class="navbar-header">
          <%= link_to image_tag("logo.png", height:"100%"), root_path %>
        </div>
      </div>
      <div class="col-md-4 search-form">
      <% if user_signed_in? %>
        <%= search_form_for @q, url: search_events_path, html: {method: :post} do |f| %>
          <div class="input-group">
            <%= f.search_field :title_cont,
              id: "filter-autocomplete-search",
              class: "form-control search-bar",
              data: {autocomplete_source: Event.order(:title).map(&:title)},
              placeholder: "Search Events' titles" %>
            <span class="input-group-btn">
              <%= f.submit class: "btn btn-default search-btn" %>
            </span>
          </div>
        <% end %>
      <% end%>
      </div>
      <div class="col-md-7">
        <nav>
          <ul class="nav navbar-nav navbar-right">
            <li><%= link_to t(".events"), events_path %></li>
            <li><%= link_to t(".contact"), contact_path %></li>
            <% if user_signed_in? %>
              <% if admin_user? %>
                <li>
                  <li><%= link_to "Manage", admin_statistics_path %></li>
                </li>
              <% end %>
              <li class="dropdown">
                <a href = "#" class = "dropdown-toggle" data-toggle = "dropdown">
                  <%= image_tag current_user.picture_url(:thumb) if current_user.picture.present? %>
                  <%= t ".account" %> <b class="caret"></b>
                </a>
                <ul class = "dropdown-menu">
                  <li><%= link_to current_user.name, current_user %></li>
                  <li><%= link_to t(".setting"), edit_user_path(current_user) %></li>
                  <% if is_creator? %>
                    <li><%= link_to t(".create"), new_event_path %></li>
                  <% end %>
                  <li class = "divider"></li>
                  <li>
                    <%= link_to t(".log_out"), destroy_user_session_path, method: :delete %>
                  </li>
                </ul>
              </li>
            <% else %>
              <%= link_to t(".log_in"), new_user_session_path, class: "btn btn-default navbar-btn" %>
              <%= link_to t(".sign_up"), new_user_registration_path, class: "btn btn-default navbar-btn signup" %>
            <% end %>
          </ul>
        </nav>
      </div>
    </div>
  </div>
</header>

<script type="text/javascript">
  $("#filter-autocomplete-search").autocomplete({
    source: $("#filter-autocomplete-search").data("autocomplete-source"),
    minLength: 1
  });
</script>
